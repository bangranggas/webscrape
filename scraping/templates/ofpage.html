<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>OF Albums - Modern Collection</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Alpine.js for interactivity -->
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />

    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              inter: ['Inter', 'sans-serif'],
            },
            colors: {
              primary: {
                50: '#f0fdfa',
                500: '#14b8a6',
                600: '#0d9488',
                700: '#0f766e',
              },
              secondary: {
                500: '#f97316',
                600: '#ea580c',
              },
            },
            animation: {
              'fade-in': 'fadeIn 0.5s ease-in-out',
              'slide-up': 'slideUp 0.5s ease-out',
              'pulse-slow': 'pulse 3s infinite',
            },
          },
        },
      };
    </script>

    <style>
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      @keyframes slideUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .glass-effect {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      .gradient-bg {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      }

      .album-card {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .album-card:hover {
        transform: translateY(-8px) scale(1.02);
      }

      .image-container {
        position: relative;
        overflow: hidden;
      }

      .image-container img {
        transition: transform 0.3s ease;
      }

      .image-container:hover img {
        transform: scale(1.1);
      }

      .carousel-dots {
        position: absolute;
        bottom: 1rem;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 0.5rem;
      }

      .carousel-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.5);
        cursor: pointer;
        transition: background 0.3s;
      }

      .carousel-dot.active {
        background: rgba(255, 255, 255, 1);
      }

      .search-glow:focus {
        box-shadow: 0 0 0 3px rgba(20, 184, 166, 0.1), 0 0 20px rgba(20, 184, 166, 0.2);
      }
    </style>
  </head>

  <body class="font-inter bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 min-h-screen" x-data="albumApp()">
    <!-- Modern Navigation Header -->
    <nav class="sticky top-0 z-50 glass-effect border-b border-white/20">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-16">
          <!-- Logo -->
          <div class="flex items-center space-x-3">
            <div class="w-10 h-10 bg-gradient-to-r from-primary-500 to-secondary-500 rounded-lg flex items-center justify-center">
              <i class="fas fa-images text-white text-lg"></i>
            </div>
            <h1 class="text-xl font-bold text-gray-800">My Collection</h1>
          </div>

          <!-- Navigation Links -->
          <div class="hidden md:flex space-x-1">
            <a href="/gdrive" class="px-4 py-2 text-sm font-medium text-gray-700 hover:text-primary-600 hover:bg-white/50 rounded-lg transition-all"> <i class="fas fa-cloud mr-2"></i>GDrive </a>
            <a href="/" class="px-4 py-2 text-sm font-medium text-white bg-primary-500 rounded-lg shadow-lg"> <i class="fas fa-star mr-2"></i>OF Albums </a>
            <a href="/custom" class="px-4 py-2 text-sm font-medium text-gray-700 hover:text-primary-600 hover:bg-white/50 rounded-lg transition-all"> <i class="fas fa-palette mr-2"></i>OF Custom </a>
          </div>

          <!-- Mobile menu button -->
          <div class="md:hidden">
            <button @click="mobileMenuOpen = !mobileMenuOpen" class="p-2 rounded-lg hover:bg-white/50 transition-all">
              <i class="fas fa-bars text-gray-700"></i>
            </button>
          </div>
        </div>

        <!-- Mobile menu -->
        <div x-show="mobileMenuOpen" x-transition class="md:hidden py-4 space-y-2">
          <a href="/gdrive" class="block px-4 py-2 text-sm font-medium text-gray-700 hover:bg-white/50 rounded-lg"> <i class="fas fa-cloud mr-2"></i>GDrive </a>
          <a href="/" class="block px-4 py-2 text-sm font-medium text-white bg-primary-500 rounded-lg"> <i class="fas fa-star mr-2"></i>OF Albums </a>
          <a href="/custom" class="block px-4 py-2 text-sm font-medium text-gray-700 hover:bg-white/50 rounded-lg"> <i class="fas fa-palette mr-2"></i>OF Custom </a>
        </div>
      </div>
    </nav>

    <!-- Hero Section -->
    <div class="relative overflow-hidden">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 sm:py-16">
        <div class="text-center space-y-6">
          <h1 class="text-4xl sm:text-5xl lg:text-6xl font-bold">
            <span class="bg-gradient-to-r from-primary-600 via-purple-600 to-secondary-600 bg-clip-text text-transparent"> OF Albums </span>
          </h1>
          <p class="text-lg sm:text-xl text-gray-600 max-w-3xl mx-auto">Discover and explore our curated collection of premium albums</p>

          <!-- Enhanced Search Bar -->
          <div class="max-w-md mx-auto mt-8">
            <div class="relative group">
              <i class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 group-focus-within:text-primary-500 transition-colors"></i>
              <input
                type="text"
                x-model="searchTerm"
                @input="applyFilters()"
                placeholder="Search albums by title..."
                class="w-full pl-12 pr-4 py-4 bg-white/80 backdrop-blur-sm rounded-2xl border border-white/30 shadow-xl focus:outline-none focus:ring-4 focus:ring-primary-500/20 focus:border-primary-400 search-glow transition-all text-gray-700 placeholder-gray-400" />
              <div x-show="searchTerm" @click="searchTerm = ''; applyFilters()" class="absolute right-4 top-1/2 transform -translate-y-1/2 cursor-pointer text-gray-400 hover:text-gray-600 transition-colors">
                <i class="fas fa-times"></i>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Decorative elements -->
      <div class="-z-10 absolute top-0 -right-4 w-72 h-72 bg-purple-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-pulse-slow"></div>
      <div class="-z-10 absolute top-0 -left-4 w-72 h-72 bg-primary-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-pulse-slow"></div>
    </div>

    <!-- Filters and Categories -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mb-8">
      <!-- Category Pills -->
      <div class="flex flex-wrap justify-center gap-2 mb-6">
        <button
          @click="currentCategory = 'all'; applyFilters()"
          :class="currentCategory === 'all' ? 'bg-primary-500 text-white shadow-lg' : 'bg-white/70 text-gray-700 hover:bg-white/90'"
          class="px-6 py-3 rounded-full font-medium transition-all duration-200 backdrop-blur-sm border border-white/30">
          <i class="fas fa-th-large mr-2"></i>All Categories
        </button>
        <template x-for="category in categories" :key="category">
          <button
            @click="currentCategory = category; applyFilters()"
            :class="currentCategory === category ? 'bg-primary-500 text-white shadow-lg' : 'bg-white/70 text-gray-700 hover:bg-white/90'"
            class="px-6 py-3 rounded-full font-medium transition-all duration-200 backdrop-blur-sm border border-white/30"
            x-text="category"></button>
        </template>
      </div>

      <!-- Results info -->
      <div class="text-center text-gray-600 mb-4">
        <span x-text="`Showing ${Math.min(filteredAlbums.length, itemsPerPage)} of ${filteredAlbums.length} albums`"></span>
        <span x-show="currentCategory !== 'all'" x-text="`in ${currentCategory}`"></span>
        <span x-show="searchTerm" x-text="`matching '${searchTerm}'`"></span>
      </div>
    </div>

    <!-- Albums Grid -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mb-12">
      <!-- Loading State -->
      <div x-show="loading" class="text-center py-12">
        <div class="inline-block animate-spin rounded-full h-12 w-12 border-4 border-primary-200 border-t-primary-500"></div>
        <p class="mt-4 text-gray-600">Loading amazing albums...</p>
      </div>

      <!-- No Results -->
      <div x-show="!loading && paginatedAlbums.length === 0" class="text-center py-12">
        <div class="w-24 h-24 mx-auto mb-6 bg-gray-100 rounded-full flex items-center justify-center">
          <i class="fas fa-search text-3xl text-gray-400"></i>
        </div>
        <h3 class="text-xl font-medium text-gray-900 mb-2">No albums found</h3>
        <p class="text-gray-600" x-show="searchTerm">No albums match your search for "<span x-text="searchTerm"></span>". Try adjusting your search terms.</p>
        <p class="text-gray-600" x-show="!searchTerm && currentCategory !== 'all'">No albums found in the "<span x-text="currentCategory"></span>" category.</p>
      </div>

      <!-- Albums Grid -->
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 sm:gap-8">
        <template x-for="album in paginatedAlbums" :key="album.id">
          <div class="album-card bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/30 overflow-hidden group">
            <!-- Album Header -->
            <div class="bg-gradient-to-r from-gray-800 to-gray-900 px-6 py-4">
              <h3 class="text-white font-semibold text-lg truncate" x-text="album.title"></h3>
              <p class="text-gray-300 text-sm" x-text="album.category"></p>
            </div>

            <!-- Image Carousel Container -->
            <div
              class="relative h-80 sm:h-96 image-container"
              x-data="{ 
    currentSlide: 0, 
    startAutoSlide() {
        this.autoSlideInterval = setInterval(() => {
            this.currentSlide = (this.currentSlide + 1) % this.album.preview.length;
        }, 5000);
    },
}"
              x-init="startAutoSlide">
              <template x-for="(image, index) in album.preview" :key="index">
                <div
                  x-show="currentSlide === index"
                  x-transition:enter="transition ease-out duration-300"
                  x-transition:enter-start="opacity-0 transform scale-95"
                  x-transition:enter-end="opacity-100 transform scale-100"
                  class="absolute inset-0">
                  <img :src="image" :alt="`${album.title} - Image ${index + 1}`" class="w-full h-full object-contain bg-gray-100" onerror="this.src='https://via.placeholder.com/400x300/e5e7eb/9ca3af?text=Image+Not+Found'" loading="lazy" />
                </div>
              </template>

              <!-- Navigation Arrows -->
              <template x-if="album.preview.length > 1">
                <div>
                  <button
                    @click="currentSlide = currentSlide === 0 ? album.preview.length - 1 : currentSlide - 1"
                    class="absolute left-2 top-1/2 transform -translate-y-1/2 w-10 h-10 bg-black/50 hover:bg-black/70 text-white rounded-full flex items-center justify-center transition-all opacity-0 group-hover:opacity-100">
                    <i class="fas fa-chevron-left"></i>
                  </button>
                  <button
                    @click="currentSlide = currentSlide === album.preview.length - 1 ? 0 : currentSlide + 1"
                    class="absolute right-2 top-1/2 transform -translate-y-1/2 w-10 h-10 bg-black/50 hover:bg-black/70 text-white rounded-full flex items-center justify-center transition-all opacity-0 group-hover:opacity-100">
                    <i class="fas fa-chevron-right"></i>
                  </button>
                </div>
              </template>

              <!-- Dots Indicator -->
              <template x-if="album.preview.length > 1">
                <div class="carousel-dots">
                  <template x-for="(image, index) in album.preview" :key="index">
                    <button @click="currentSlide = index" :class="currentSlide === index ? 'active' : ''" class="carousel-dot"></button>
                  </template>
                </div>
              </template>

              <!-- Image Counter -->
              <template x-if="album.preview.length > 1">
                <div class="absolute top-4 right-4 bg-black/70 text-white px-3 py-1 rounded-full text-sm font-medium"><span x-text="currentSlide + 1"></span>/<span x-text="album.preview.length"></span></div>
              </template>
            </div>

            <!-- Album Footer -->
            <div class="p-6">
              <div class="flex flex-wrap gap-2">
                <template x-for="(link, index) in album.links" :key="index">
                  <a
                    :href="link"
                    target="_blank"
                    class="flex-1 min-w-0 bg-gradient-to-r from-primary-500 to-primary-600 hover:from-primary-600 hover:to-primary-700 text-white px-4 py-3 rounded-xl font-medium text-center transition-all duration-200 transform hover:-translate-y-1 hover:shadow-lg">
                    <i class="fas fa-external-link-alt mr-2"></i>
                    <span x-text="album.links.length > 1 ? `Link ${index + 1}` : 'Open Album'"></span>
                  </a>
                </template>
              </div>
            </div>
          </div>
        </template>
      </div>
    </div>

    <!-- Modern Pagination -->
    <div x-show="totalPages > 1" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mb-12">
      <div class="flex justify-center">
        <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/30 p-2">
          <div class="flex items-center space-x-1">
            <!-- Previous Button -->
            <button @click="goToPage(currentPage - 1)" :disabled="currentPage === 1" :class="currentPage === 1 ? 'opacity-50 cursor-not-allowed' : 'hover:bg-primary-50'" class="px-4 py-2 rounded-xl font-medium transition-all">
              <i class="fas fa-chevron-left"></i>
            </button>

            <!-- Page Numbers -->
            <template x-for="page in getPageNumbers()" :key="page">
              <button
                @click="goToPage(page)"
                :class="page === currentPage ? 'bg-primary-500 text-white shadow-lg' : 'text-gray-700 hover:bg-primary-50'"
                class="px-4 py-2 rounded-xl font-medium transition-all min-w-[2.5rem]"
                x-text="page"></button>
            </template>

            <!-- Next Button -->
            <button
              @click="goToPage(currentPage + 1)"
              :disabled="currentPage === totalPages"
              :class="currentPage === totalPages ? 'opacity-50 cursor-not-allowed' : 'hover:bg-primary-50'"
              class="px-4 py-2 rounded-xl font-medium transition-all">
              <i class="fas fa-chevron-right"></i>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="bg-white/50 backdrop-blur-sm border-t border-white/30 py-8">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <p class="text-gray-600">
          <i class="fas fa-heart text-red-400 mx-1"></i>
          Albums Collection - Built with care
        </p>
      </div>
    </footer>

    <script>
      function albumApp() {
        return {
          // App State
          loading: true,
          mobileMenuOpen: false,
          allAlbums: [],
          filteredAlbums: [],
          paginatedAlbums: [],
          categories: [],
          currentSlide: 1,

          // Filters
          searchTerm: '',
          currentCategory: 'all',

          // Pagination
          currentPage: 1,
          itemsPerPage: 12,
          totalPages: 1,

          // Initialize app
          async init() {
            this.loading = true;
            await this.fetchDataFromBackend();
            this.loading = false;
            this.applyFilters();
            this.startCarousel();
          },

          // Fetch data from backend (replace sample data when API is ready)
          async fetchDataFromBackend() {
            try {
              const response = await fetch('/scrape-data-of');
              const data = await response.json();
              this.processBackendData(data); // Process the data once it's fetched
            } catch (error) {
              console.error('Error fetching data:', error);
            }
          },

          // Process the backend data structure
          processBackendData(data) {
            this.allAlbums = [];
            const categories = [];

            // Convert your data structure to our internal format
            for (const categoryName in data) {
              if (data.hasOwnProperty(categoryName)) {
                categories.push(categoryName);
                const categoryData = data[categoryName];

                for (const albumId in categoryData) {
                  if (categoryData.hasOwnProperty(albumId)) {
                    const album = categoryData[albumId];
                    this.allAlbums.push({
                      id: `${categoryName}_${albumId}`,
                      title: album.title,
                      category: categoryName,
                      preview: album.preview || [],
                      links: album.link || [],
                    });
                  }
                }
              }
            }

            this.categories = categories;
          },

          // Apply search and category filters
          applyFilters() {
            let filtered = this.allAlbums;

            // Category filter
            if (this.currentCategory !== 'all') {
              filtered = filtered.filter((album) => album.category === this.currentCategory);
            }

            // Search filter
            if (this.searchTerm.trim()) {
              const term = this.searchTerm.toLowerCase();
              filtered = filtered.filter((album) => album.title.toLowerCase().includes(term) || album.category.toLowerCase().includes(term));
            }

            this.filteredAlbums = filtered;
            this.totalPages = Math.ceil(this.filteredAlbums.length / this.itemsPerPage);
            this.currentPage = 1; // Reset to first page when filters change
            this.updatePaginatedAlbums();
          },

          // Update paginated albums
          updatePaginatedAlbums() {
            const start = (this.currentPage - 1) * this.itemsPerPage;
            const end = start + this.itemsPerPage;
            this.paginatedAlbums = this.filteredAlbums.slice(start, end);
          },

          // Navigate to specific page
          goToPage(page) {
            if (page >= 1 && page <= this.totalPages) {
              this.currentPage = page;
              this.updatePaginatedAlbums();
              // Scroll to top
              window.scrollTo({ top: 0, behavior: 'smooth' });
            }
          },

          // Get page numbers for pagination
          getPageNumbers() {
            const pages = [];
            const maxVisible = 5;
            let start = Math.max(1, this.currentPage - Math.floor(maxVisible / 2));
            let end = Math.min(this.totalPages, start + maxVisible - 1);

            // Adjust start if we're near the end
            if (end - start + 1 < maxVisible) {
              start = Math.max(1, end - maxVisible + 1);
            }

            for (let i = start; i <= end; i++) {
              pages.push(i);
            }

            return pages;
          },
        };
      }
    </script>
  </body>
</html>
